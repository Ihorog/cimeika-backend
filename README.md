# CIMEIKA Backend

**7 Agents on Cloudflare Workers** | TypeScript + Hono + Agents SDK

## ĞŸÑ€Ğ¾ Cimeika

**Cimeika** - Ñ†Ğµ ĞµĞºĞ¾ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ñ–Ğ½Ñ‚ĞµĞ»ĞµĞºÑ‚ÑƒĞ°Ğ»ÑŒĞ½Ğ¸Ñ… Ğ°Ğ³ĞµĞ½Ñ‚Ñ–Ğ² Ğ´Ğ»Ñ Ñ‚Ğ²Ğ¾Ñ€Ñ‡Ğ¾ÑÑ‚Ñ– Ñ‚Ğ° ÑƒĞ¿Ñ€Ğ°Ğ²Ğ»Ñ–Ğ½Ğ½Ñ ĞºĞ¾Ğ½Ñ‚ĞµĞ½Ñ‚Ğ¾Ğ¼.

### Ğ ĞµÑÑƒÑ€ÑĞ¸
- ğŸŒ **Ğ’ĞµĞ±ÑĞ°Ğ¹Ñ‚:** [cimeika.com.ua](https://cimeika.com.ua) | [www.cimeika.com.ua](https://www.cimeika.com.ua)
- ğŸ’» **GitHub:** [@Ihorog](https://github.com/Ihorog)
- ğŸ¤— **HuggingFace:** [@Ihorog](https://huggingface.co/Ihorog) | [API](https://huggingface.co/spaces/Ihorog/cimeika-api)
- ğŸ“§ **ĞšĞ¾Ğ½Ñ‚Ğ°ĞºÑ‚Ğ¸:** iglu963@gmail.com | cimeika.com.ua@gmail.com

### ĞŸĞ¾Ğ²'ÑĞ·Ğ°Ğ½Ñ– Ğ¿Ñ€Ğ¾Ñ”ĞºÑ‚Ğ¸
- [cit](https://github.com/Ihorog/cit) - Ğ¦ĞµĞ½Ñ‚Ñ€Ğ°Ğ»ÑŒĞ½Ğ¸Ğ¹ Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
- [ciwiki](https://github.com/Ihorog/ciwiki) - Wiki ÑĞ¸ÑÑ‚ĞµĞ¼Ğ°
- [cimeika-unified](https://github.com/Ihorog/cimeika-unified) - Ğ£Ğ½Ñ–Ñ„Ñ–ĞºĞ¾Ğ²Ğ°Ğ½Ğ¸Ğ¹ Ñ–Ğ½Ñ‚ĞµÑ€Ñ„ĞµĞ¹Ñ
- [cimeika-app](https://github.com/Ihorog/cimeika-app) - ĞœĞ¾Ğ±Ñ–Ğ»ÑŒĞ½Ğ¸Ğ¹ Ğ·Ğ°ÑÑ‚Ğ¾ÑÑƒĞ½Ğ¾Ğº
- [alisa-pwa-4](https://github.com/Ihorog/alisa-pwa-4) - PWA Ğ·Ğ°ÑÑ‚Ğ¾ÑÑƒĞ½Ğ¾Ğº
- [media](https://github.com/Ihorog/media) - ĞœĞµĞ´Ñ–Ğ° Ñ€ĞµÑÑƒÑ€ÑĞ¸

## ĞĞ³ĞµĞ½Ñ‚Ğ¸ (7)
- ğŸ§  **Ci** - ĞÑ€ĞºĞµÑÑ‚Ñ€Ğ°Ñ†Ñ–Ñ Ñ‚Ğ° Ğ¼Ğ¾Ğ½Ñ–Ñ‚Ğ¾Ñ€Ğ¸Ğ½Ğ³
- ğŸ“… **ĞŸĞ¾Ğ´Ñ–Ñ** - ĞŸĞ¾Ğ´Ñ–Ñ— Ñ‚Ğ° Ñ‚Ñ€Ğ¸Ğ³ĞµÑ€Ğ¸
- ğŸ’­ **ĞĞ°ÑÑ‚Ñ€Ñ–Ğ¹** - Ğ’Ñ–Ğ´ÑÑ‚ĞµĞ¶ĞµĞ½Ğ½Ñ Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ñ
- ğŸ’¡ **ĞœĞ°Ğ»Ñ** - Ğ†Ğ´ĞµÑ— Ñ‚Ğ° Ñ‚Ğ²Ğ¾Ñ€Ñ‡Ñ–ÑÑ‚ÑŒ
- ğŸ“– **ĞšĞ°Ğ·ĞºĞ°Ñ€** - Ğ†ÑÑ‚Ğ¾Ñ€Ñ–Ñ— Ñ‚Ğ° Ğ½Ğ°Ñ€Ğ°Ñ‚Ğ¸Ğ²
- â° **ĞšĞ°Ğ»ĞµĞ½Ğ´Ğ°Ñ€** - Ğ§Ğ°Ñ Ñ‚Ğ° Ñ€Ğ¸Ñ‚Ğ¼Ğ¸
- ğŸ–¼ï¸ **Ğ“Ğ°Ğ»ĞµÑ€ĞµÑ** - Ğ—Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ½Ñ (R2)

## Tech Stack
- **Runtime:** Cloudflare Workers
- **Language:** TypeScript 5.x (strict mode)
- **Framework:** Hono ^4.0.0
- **AI:** OpenAI SDK ^4.77.0
- **Agents:** `agents` SDK
- **Storage:** KV, D1, R2, Analytics Engine

## API Endpoints

### Core
| Endpoint | Method | Description |
|----------|--------|-------------|
| `/api/health` | GET | Health check (status, checks, agents count) |
| `/api/status` | GET | Detailed system + agent status |
| `/api/manifest` | GET | API documentation listing |

### Agent Endpoints
Each of the 7 agents exposes:
| Pattern | Method | Description |
|---------|--------|-------------|
| `/api/agents/{agent}/status` | GET | Agent status |
| `/api/agents/{agent}` | POST | Send message to agent |

## Setup

### 1. Install Dependencies
```bash
npm install
```

### 2. Create Cloudflare Resources
```bash
# KV Namespaces
wrangler kv:namespace create CONFIG
wrangler kv:namespace create AUTH_TOKENS

# D1 Database
wrangler d1 create cimeika

# R2 Bucket
wrangler r2 bucket create cimeika-files
```

### 3. Update wrangler.jsonc
Fill in the IDs from previous commands.

### 4. Set Secrets
```bash
wrangler secret put GITHUB_TOKEN
wrangler secret put OPENAI_API_KEY
wrangler secret put HUGGINGFACE_TOKEN
wrangler secret put VERCEL_TOKEN
```

### 5. Run Locally
```bash
npm run dev
```

### 6. Deploy
```bash
npm run deploy
```

## Development

### Type Checking
```bash
npm run types
```

### Testing
```bash
npm test
npm run test:coverage
```

## Monitoring

### Health Check
```bash
curl https://cimeika-backend.workers.dev/api/health
```

Expected response:
```json
{
  "status": "UP",
  "timestamp": "2026-02-19T18:00:00.000Z",
  "version": "0.1.0",
  "environment": "production",
  "agents": 7,
  "checks": { "kv": true, "analytics": true, "database": true }
}
```

### Metrics
- Metrics are written to the **Analytics Engine** (`ANALYTICS` binding).
- `logMetric(env, name, value, tags)` â€“ low-level metric write.
- `reportEndpointMetric(env, endpoint, method, status, durationMs)` â€“ per-request latency/status.
- `reportAgentStatus(env, agent, uptime, errors)` â€“ agent health.
- `alert(env, message, severity)` â€“ high-priority alert persisted to KV + Analytics.

## Architecture
```
src/
â”œâ”€â”€ index.ts              # Entry point, routing
â”œâ”€â”€ agents/               # 7 Durable Objects
â”‚   â”œâ”€â”€ base-agent.ts
â”‚   â”œâ”€â”€ ci-agent.ts
â”‚   â”œâ”€â”€ podiya-agent.ts
â”‚   â”œâ”€â”€ nastriy-agent.ts
â”‚   â”œâ”€â”€ malya-agent.ts
â”‚   â”œâ”€â”€ kazkar-agent.ts
â”‚   â”œâ”€â”€ kalendar-agent.ts
â”‚   â””â”€â”€ gallery-agent.ts
â”œâ”€â”€ integrations/         # External APIs
â”‚   â”œâ”€â”€ github.ts
â”‚   â”œâ”€â”€ huggingface.ts
â”‚   â””â”€â”€ vercel.ts
â”œâ”€â”€ middleware/           # Auth, CORS, Rate Limit
â”œâ”€â”€ types/                # TypeScript definitions
â””â”€â”€ lib/                  # Utilities
    â”œâ”€â”€ health-check.ts   # getHealthStatus, verifyDeployment
    â””â”€â”€ monitoring.ts     # logMetric, reportError, alert, â€¦
```

## Language Invariant
- **UI:** Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°
- **Code:** English
- **API Messages:** Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°
- **Docs:** Ğ£ĞºÑ€Ğ°Ñ—Ğ½ÑÑŒĞºĞ°

## Status
```
Backend: 100%
Agents: 7/7
Monitoring: âœ…
Deployment: âœ… (pending Cloudflare resources)
```

## License
MIT
